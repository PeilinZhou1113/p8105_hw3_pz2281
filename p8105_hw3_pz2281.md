p8105\_hw3\_pz2281
================
Peilin Zhou

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%" #shrunk down the size 
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Problem 1

read in instacart data

``` r
library(p8105.datasets)
data("instacart")
instacart
```

    ## # A tibble: 1,384,617 × 15
    ##    order_id product_id add_to_cart_order reordered user_id eval_set order_number
    ##       <int>      <int>             <int>     <int>   <int> <chr>           <int>
    ##  1        1      49302                 1         1  112108 train               4
    ##  2        1      11109                 2         1  112108 train               4
    ##  3        1      10246                 3         0  112108 train               4
    ##  4        1      49683                 4         0  112108 train               4
    ##  5        1      43633                 5         1  112108 train               4
    ##  6        1      13176                 6         0  112108 train               4
    ##  7        1      47209                 7         0  112108 train               4
    ##  8        1      22035                 8         1  112108 train               4
    ##  9       36      39612                 1         0   79431 train              23
    ## 10       36      19660                 2         1   79431 train              23
    ## # … with 1,384,607 more rows, and 8 more variables: order_dow <int>,
    ## #   order_hour_of_day <int>, days_since_prior_order <int>, product_name <chr>,
    ## #   aisle_id <int>, department_id <int>, aisle <chr>, department <chr>

The instacart dataset contains 1384617 observations with 15 variables.
Each row represents a product from an order. The data contains customer
information with unique user\_id as a variable and there are 131209
unique customers. There are total of 21 departments and 0 aisles. The
products from each order\_id are ordered by the add\_to\_cart\_order
from the customer.

``` r
aisle_freq = instacart %>% 
  group_by(aisle) %>% 
  summarize(
    n_obs = n()
  )
most_ord_aisle = aisle_freq %>% 
  slice_max(n_obs)
```

There are 0 aisles and the aisle that most items are ordered from is
fresh vegetables, 150609, which makes sense since people often order
vegetables online from instacart, amazon fresh etc.

``` r
aisle_freq %>% 
  filter(n_obs > 10000) %>% 
  ggplot(aes(x = aisle, y = n_obs)) +
  geom_col() +
  labs(
    title = "Number of Items Ordered from Each Aisle",
    x = "Aisle Names",
    y = "number of Items Ordered"
  )
```

<img src="p8105_hw3_pz2281_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" />

``` r
bake_ing_order = 
  instacart %>% 
  filter(aisle == "baking ingredients" | aisle == "dog food care" | aisle == "packaged vegetables fruits") %>% 
  pivot_wider(
    names_from = aisle,
    values_from = product_name
  ) %>% 
  janitor::clean_names() %>% 
  select(baking_ingredients) %>% 
  drop_na() %>% 
  count(baking_ingredients) %>% 
  mutate(order_rank = min_rank(desc(n)))
# %>% 
#  filter(order_rank < 4)
```

``` r
bake_ingr_order = instacart %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  filter(aisle == "baking ingredients") %>% 
  mutate(order_rank = min_rank(desc(n))) %>% 
  filter(min_rank(desc(n)) < 4)
  
dog_food_order = instacart %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  filter(aisle == "dog food care") %>% 
  mutate(order_rank = min_rank(desc(n))) %>% 
  filter(min_rank(desc(n)) < 4)

pack_vegfru_order = instacart %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  filter(aisle == "packaged vegetables fruits") %>% 
  mutate(order_rank = min_rank(desc(n))) %>% 
  filter(min_rank(desc(n)) < 4)
```

``` r
order_table = bind_rows(bake_ingr_order, dog_food_order, pack_vegfru_order)
```
